<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chat with Kristina's AI Assistant</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body { background: linear-gradient(135deg, #00bfb3 0%, #00d4c8 50%, #05e8d8 100%); min-height:100vh; display:flex; justify-content:center; align-items:center; padding:20px; }
    .chatbot-fullpage { width:100%; max-width:800px; height:80vh; min-height:500px; background:white; border-radius:20px; box-shadow:0 20px 60px rgba(0,0,0,0.3); display:flex; flex-direction:column; overflow:hidden; position:relative; }
    .chatbot-header { background: linear-gradient(135deg, #00bfb3 0%, #00d4c8 100%); color:white; padding:30px; text-align:center; }
    .chatbot-header h1 { font-size:28px; margin-bottom:10px; }
    .chatbot-header p { font-size:16px; opacity:0.9; }
    .contact-links { display:flex; justify-content:center; gap:20px; margin-top:15px; flex-wrap:wrap; }
    .contact-links a { color:white; text-decoration:none; font-size:14px; display:flex; align-items:center; gap:8px; background: rgba(255,255,255,0.2); padding:8px 15px; border-radius:20px; transition:all .3s; }
    .contact-links a:hover { background: rgba(255,255,255,0.3); transform:translateY(-2px); }
    .chatbot-messages { flex:1; padding:30px; overflow-y:auto; display:flex; flex-direction:column; gap:20px; background:#f8f9fa; }
    .message { padding:15px 20px; border-radius:15px; max-width:70%; word-wrap:break-word; animation:slideIn .3s ease; line-height:1.6; }
    @keyframes slideIn { from { opacity:0; transform:translateY(10px);} to { opacity:1; transform:translateY(0);} }
    .message.bot { background:linear-gradient(135deg,#e0f7f5 0%,#d0f2f0 100%); align-self:flex-start; border-bottom-left-radius:5px; border:2px solid #b3ece8; }
    .message.user { background:linear-gradient(135deg,#00bfb3 0%,#00d4c8 100%); color:white; align-self:flex-end; border-bottom-right-radius:5px; }
    .typing-indicator { display:flex; gap:8px; padding:15px 20px; background:linear-gradient(135deg,#e0f7f5 0%,#d0f2f0 100%); border-radius:15px; border-bottom-left-radius:5px; width:fit-content; border:2px solid #b3ece8; }
    .typing-indicator span { width:10px; height:10px; border-radius:50%; background:#00bfb3; animation:bounce 1.4s infinite; }
    .typing-indicator span:nth-child(2) { animation-delay:.2s; }
    .typing-indicator span:nth-child(3) { animation-delay:.4s; }
    @keyframes bounce { 0%,60%,100%{ transform:translateY(0);} 30%{ transform:translateY(-15px);} }
    .chatbot-input-area { padding:25px 30px; border-top:2px solid #eee; display:flex; gap:15px; background:white; }
    .chatbot-input { flex:1; padding:15px 20px; border:2px solid #eee; border-radius:30px; font-size:16px; outline:none; transition:all .3s; }
    .chatbot-input:focus { border-color:#00bfb3; box-shadow:0 0 0 3px rgba(0,191,179,0.1); }
    .chatbot-send-btn { width:55px; height:55px; border-radius:50%; background:linear-gradient(135deg,#00bfb3 0%,#00d4c8 100%); color:white; border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all .3s; font-size:20px; }
    .chatbot-send-btn:hover { transform:scale(1.1); box-shadow:0 5px 20px rgba(0,191,179,0.4); }
    .back-link { position:absolute; top:20px; left:20px; background: rgba(255,255,255,0.2); color:white; padding:10px 20px; border-radius:25px; text-decoration:none; font-weight:500; transition:all .3s; backdrop-filter: blur(10px); }
    .back-link:hover { background: rgba(255,255,255,0.3); transform:translateY(-2px); }
    .suggestions { display:flex; flex-wrap:wrap; gap:10px; padding:0 30px 20px; background:#f8f9fa; }
    .suggestion-chip { background:white; border:2px solid #b3ece8; padding:8px 16px; border-radius:20px; cursor:pointer; transition:all .3s; font-size:14px; color:#00bfb3; font-weight:500; }
    .suggestion-chip:hover { background:#00bfb3; color:white; transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,191,179,0.3); }

    @media (max-width:768px){
      body{ padding:0; }
      .chatbot-fullpage{ height:100vh; max-width:100%; border-radius:0; }
      .message{ max-width:85%; }
      .chatbot-header h1{ font-size:24px; }
      .chatbot-header p{ font-size:14px; }
      .back-link{ top:10px; left:10px; padding:8px 16px; font-size:14px; }
      .chatbot-messages{ padding:20px 15px; }
      .chatbot-input-area{ padding:20px 15px; }
      .suggestions{ padding:0 15px 15px; }
      .suggestion-chip{ font-size:12px; padding:6px 12px; }
      .contact-links{ gap:10px; }
      .contact-links a{ font-size:12px; padding:6px 12px; }
    }
    @media (max-width:480px){
      .chatbot-header{ padding:20px 15px; }
      .chatbot-header h1{ font-size:20px; }
      .contact-links{ flex-direction:column; gap:8px; }
    }
  </style>
</head>
<body>
  <a href="index.html" class="back-link">‚Üê Back to Website</a>

  <div class="chatbot-fullpage" role="main" aria-label="Chat with Kristina's AI Assistant">
    <div class="chatbot-header">
      <h1>üí¨ Chat with Kristina's AI Assistant</h1>
      <p>Ask me anything about Kristina's professional experience, skills, and availability!</p>
      <div class="contact-links" aria-hidden="false">
        <a href="mailto:kristinazhi97@gmail.com">üìß Email</a>
        <a href="tel:+447497391831">üì± Call</a>
        <a href="https://www.linkedin.com/in/kristina-hanxhara-b41a29223/" target="_blank" rel="noopener">üîó LinkedIn</a>
      </div>
    </div>

    <div class="suggestions" id="suggestions">
      <div class="suggestion-chip" data-q="What is Kristina's experience?">What's her experience?</div>
      <div class="suggestion-chip" data-q="What skills does Kristina have?">What are her skills?</div>
      <div class="suggestion-chip" data-q="Is Kristina available for work?">Is she available?</div>
      <div class="suggestion-chip" data-q="What is Kristina's education background?">Education background</div>
      <div class="suggestion-chip" data-q="How can I contact Kristina?">Contact information</div>
    </div>

    <div class="chatbot-messages" id="chatbotMessages" aria-live="polite">
      <div class="message bot">üëã Hello! I'm Kristina's AI assistant. I can help you learn about her professional career, technical skills, education, and availability. Feel free to ask me anything!</div>
    </div>

    <div class="chatbot-input-area">
      <input type="text" id="chatbotInput" class="chatbot-input" placeholder="Type your question here..." aria-label="Type your question" />
      <button class="chatbot-send-btn" id="chatbotSend" aria-label="Send message">‚û§</button>
    </div>
  </div>

  <script>
    // Client-side: uses a server-side proxy (/api/generate) to keep API key safe server-side.
    // Make sure your server implements POST /api/generate { prompt, userMessage } -> { reply }

    const kristinaInfo = {
      name: "Kristina Hanxhara",
      title: "AI Expert & Chatbot Developer",
      location: "London, UK",
      phone: "07497391831",
      email: "kristinazhi97@gmail.com",
      linkedin: "https://www.linkedin.com/in/kristina-hanxhara-b41a29223/",
      availability: "Available immediately",
      age: "27 years old",
      education: {
        current: "Master of Science in Data Science and Artificial Intelligence at University of Liverpool (April 2024 ‚Äì Present)",
        bachelor: "Bachelor's in Business Informatics (with High Honors) from University of Korca 'Fan Noli', Albania (October 2018 ‚Äì October 2021)",
        certifications: ["Front-End Development (HTML, CSS, JavaScript)", "Finance 5, AlphaWeb"]
      },
      experience: [
        { title: "Panel Quality Principal Analyst", company: "GfK, London", period: "September 2022 ‚Äì Present", responsibilities: "Designs and monitors representative samples for retail analysis, collaborates with cross-functional teams, delivers actionable insights, implements data quality monitoring systems" },
        { title: "Recruitment Consultant and Payroll Admin", company: "Team Support, London", period: "May 2021 ‚Äì June 2022" },
        { title: "Market Research Interviewer", company: "GfK, Tirana", period: "May 2017 ‚Äì September 2018" }
      ],
      skills: {
        ai: ["Chatbot Development", "OpenAI API", "Google APIs", "Computer Vision", "OpenCV", "API Integration"],
        technical: ["Python", "HTML", "CSS", "JavaScript", "SQL", "MySQL", "API Development", "Website Development"],
        languages: ["Albanian (native)", "English (fluent)", "German (fluent)", "Spanish (fluent)"]
      },
      projects: [
        { name: "Vila Falo Resort Website", description: "Complete business website for a luxury mountain resort with multilingual content, booking system, and responsive design", link: "http://www.vilafalo.com/" },
        { name: "AI Assistant Chatbot", description: "Intelligent assistant using Google Gemini API that answers questions about professional experience" }
      ],
      hobbies: ["Reading", "Traveling", "AI Research", "Business Topics", "Startups", "AI Philosophy", "Innovation"]
    };

    const chatbotMessages = document.getElementById('chatbotMessages');
    const chatbotInput = document.getElementById('chatbotInput');
    const chatbotSend = document.getElementById('chatbotSend');
    const suggestionsEl = document.getElementById('suggestions');

    let isWaitingForReply = false;

    function addMessage(text, isBot = false) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isBot ? 'bot' : 'user'}`;
      messageDiv.textContent = text;
      chatbotMessages.appendChild(messageDiv);
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }

    function showTypingIndicator() {
      // Avoid adding multiple indicators
      if (document.getElementById('typingIndicator')) return;
      const typingDiv = document.createElement('div');
      typingDiv.className = 'typing-indicator';
      typingDiv.id = 'typingIndicator';
      typingDiv.innerHTML = '<span></span><span></span><span></span>';
      chatbotMessages.appendChild(typingDiv);
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }

    function hideTypingIndicator() {
      const typingIndicator = document.getElementById('typingIndicator');
      if (typingIndicator) typingIndicator.remove();
    }

    function buildContext() {
      return `You are an AI assistant representing Kristina Hanxhara. Answer questions ONLY about her professional career, skills, education, availability, contact information, and location (London, UK only - never give full address).

Here is the information you can share:
- Name: ${kristinaInfo.name}
- Title: ${kristinaInfo.title}
- Location: ${kristinaInfo.location} (never share full address)
- Phone: ${kristinaInfo.phone}
- Email: ${kristinaInfo.email}
- LinkedIn: ${kristinaInfo.linkedin}
- Availability: ${kristinaInfo.availability}
- Age: ${kristinaInfo.age}
- Current Education: ${kristinaInfo.education.current}
- Bachelor's: ${kristinaInfo.education.bachelor}
- Skills: ${JSON.stringify(kristinaInfo.skills)}
- Experience: ${JSON.stringify(kristinaInfo.experience)}
- Projects: ${JSON.stringify(kristinaInfo.projects)}
- Hobbies & Interests: ${(kristinaInfo.hobbies || []).join(', ')}

IMPORTANT RULES:
1. ONLY answer questions about Kristina's professional information listed above.
2. If asked about anything else (weather, general knowledge, other topics), politely redirect with: "I'm here to answer questions about Kristina's professional experience, skills, and availability. Is there anything you'd like to know about her career?"
3. Keep responses concise and professional.
4. Never share full address ‚Äî only mention "London, UK".
5. Be friendly and helpful.`;
    }

    async function sendToServerProxy(userMessage) {
      // Sends { prompt, userMessage } to a server-side endpoint /api/generate
      // Server must attach the API key and call Gemini (or other model).
      try {
        // Replace the old line with this one
const resp = await fetch('https://cv-five-self.vercel.app/api/generate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            prompt: buildContext(),
            userMessage
          })
        });

        if (!resp.ok) {
          const txt = await resp.text();
          console.error('Server returned error:', resp.status, txt);
          return "I'm having trouble connecting right now. Please try again later or contact Kristina directly at kristinazhi97@gmail.com";
        }

        const data = await resp.json();
        // Expecting { reply: "..." } from server
        if (data && typeof data.reply === 'string') return data.reply;
        // fallback
        if (data && data.error) {
          console.error('Upstream error:', data.error);
          return "I'm having trouble connecting right now. Please try again later.";
        }
        return "I'm here to answer questions about Kristina's professional experience, skills, or availability.";
      } catch (err) {
        console.error('Error calling server proxy:', err);
        return "I'm having trouble connecting right now. Please try again later or contact Kristina directly at kristinazhi97@gmail.com";
      }
    }

    async function handleUserMessage(message = null) {
      if (isWaitingForReply) return; // simple debounce to prevent spamming
      const userMessage = message || chatbotInput.value.trim();
      if (!userMessage) return;

      addMessage(userMessage, false);
      if (!message) chatbotInput.value = '';

      // UI lock while awaiting
      isWaitingForReply = true;
      chatbotSend.disabled = true;
      chatbotInput.disabled = true;
      showTypingIndicator();

      const botResponse = await sendToServerProxy(userMessage);

      hideTypingIndicator();
      addMessage(botResponse, true);

      // restore UI
      isWaitingForReply = false;
      chatbotSend.disabled = false;
      chatbotInput.disabled = false;
      chatbotInput.focus();
    }

    function askQuestion(question) {
      handleUserMessage(question);
    }

    // Suggestion chips: attach event listeners (safer than inline onclick)
    document.querySelectorAll('.suggestion-chip').forEach(chip => {
      chip.addEventListener('click', (e) => {
        const q = chip.getAttribute('data-q') || chip.textContent;
        askQuestion(q);
      });
    });

    // Keyboard & button events
    chatbotSend.addEventListener('click', () => handleUserMessage());
    chatbotInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        handleUserMessage();
      }
    });

    // Accessibility: focus input on load
    window.addEventListener('load', () => {
      chatbotInput.focus();
    });

    // Optional: small helper to pre-fill input when suggestion is hovered (non-intrusive)
    // (commented out; enable if desired)
    // document.querySelectorAll('.suggestion-chip').forEach(chip => {
    //   chip.addEventListener('mouseenter', () => chatbotInput.value = chip.getAttribute('data-q') || '');
    // });

  </script>
</body>
</html>
